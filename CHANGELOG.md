# История изменений (Changelog)

## v1.7.2
- Порядок расположения входов, выходов и параметров зависит от того местонахождения переменной или define в коде
- Генератор кода улучшен теперь блоки содержат меньше ошибок (возможно не будет падать в версии ниже 9)
- Парсер автоматически определяет тип переменной если Define используется в качестве параметра
- Исправлено добавление параметра из Define в блок
- Исправлена обработка static

## v1.6
- Добавлен определение макроса define в качестве параметра работает также по комметрарию //par
- Исправлена работа со структурами
- Устранены падения при открытии окна выбора файла
- Загрузка обновления теперь загружает сразу архив программы (опционально)

## v1.5

### Проверка обновлений
- Исправлена работа в exe на Windows: fallback SSL-контекста, когда `ssl.create_unverified_context` недоступен в bundled Python
- Обработка HTTP 404: понятное сообщение «Релизы ещё не опубликованы на GitHub» при отсутствии релизов

---

## v1.4

### Launcher exe
- Exe содержит только launcher; gui, parser, generator, constants загружаются как .py из папки
- При изменении .py пересборка exe не требуется — достаточно заменить файлы

### Проверка обновлений на GitHub
- Меню «Справка → Проверить обновления»
- Автоматическая проверка при запуске exe (тихо в фоне)
- Сравнение версии из constants.py с GitHub Releases API

### Сборка
- Exe `ino2ubi.exe` в корне проекта (без версии в имени)
- `build_exe.bat` с `cd /d "%~dp0"` для корректной работы при двойном клике
- `--distpath .` — вывод в корень

---

## v1.3

### Модульная структура
- Код разделён на отдельные модули:
  - `arduino_to_flprog_GLOBAL_COMPLETE.py` — точка входа (GUI/CLI)
  - `gui.py` — графический интерфейс PyQt5
  - `generator.py` — генерация SIXX XML для FLProg
  - `parser.py` — парсинг Arduino кода
  - `constants.py` — константы, версия, маппинг типов

### Справка в GUI
- Меню «Справка» с пунктами «Справка...» (F1) и «О программе»
- Текст справки загружается из `README.md` (поддержка Markdown)
- `README.md` включается в exe при сборке

### Разметка интерфейса
- Вкладки «Переменные» и «Функции» занимают 75% высоты правой панели
- «Настройки блока» и кнопка «Сгенерировать» — 25%

### Иконка
- Поддержка `icon.ico` для окна приложения и exe
- Fallback на стандартную иконку Qt при отсутствии файла
- Spec-файл добавляет icon.ico в bundle при сборке

### Исправления
- **Падение при открытии .ino:** при запуске exe текущая папка может быть `system32`. Диалог «Загрузить .ino» теперь использует безопасную начальную папку (домашняя пользователя), а не текущую. Метод `_get_safe_home_dir()` предотвращает открытие system32.

### Сборка
- Spec-файл: `arduino_to_flprog_GLOBAL_COMPLETE.spec`
- Exe именуется `ino2ubi_v{VERSION}.exe` (например `ino2ubi_v1.3.exe`)
- В bundle: `icon.ico`, `README.md`, модули `constants`, `parser`, `generator`, `gui`

---

## v1.2

- Начальная версия с GUI и CLI режимами
- Парсинг Arduino скетчей, генерация .ubi

---

## v1.0

- Первая версия конвертера Arduino → FLProg
